<div class="ocaml_top"><div class="ocaml_summary"><div class="info">A multiplexing XenStore protocol client over a byte-level transport, using Lwt.</div></div>
<div class="ocaml_content"><div class="ocaml_modtype" name="IO"><pre class="odoccode"><span class="keyword">module type</span> <a href="http://mirage.github.io/xenstore/#Xs_client_lwt:IO" class="ocaml_internal">IO</a> = <code class="type"><code class="code">sig</code> .. <code class="code">end</code></code></pre><div class="ocaml_summary"/><div class="ocaml_content">
<pre class="odoccode"><span class="TYPEt"><span class="keyword">type</span> <code class="type">'a </code>t</span> = <code class="type">'a <a href="http://mirage.github.io/lwt/#Lwt.t">Lwt.t</a></code></pre>
<pre class="odoccode"><span class="VALreturn"><span class="keyword">val</span> return</span> : <code class="type">'a -&gt; 'a <a href="http://mirage.github.io/xenstore/#Xs_client_lwt:IO.t" class="ocaml_internal">t</a></code></pre>
<pre class="odoccode"><span class="VAL(&gt;&gt;=)"><span class="keyword">val</span> (&gt;&gt;=)</span> : <code class="type">'a <a href="http://mirage.github.io/xenstore/#Xs_client_lwt:IO.t" class="ocaml_internal">t</a> -&gt; ('a -&gt; 'b <a href="http://mirage.github.io/xenstore/#Xs_client_lwt:IO.t" class="ocaml_internal">t</a>) -&gt; 'b <a href="http://mirage.github.io/xenstore/#Xs_client_lwt:IO.t" class="ocaml_internal">t</a></code></pre>
<pre class="odoccode"><span class="TYPEbackend"><span class="keyword">type</span> backend</span> = <code class="type">[ `unix | `xen ]</code></pre>
<pre class="odoccode"><span class="VALbackend"><span class="keyword">val</span> backend</span> : <code class="type"><a href="http://mirage.github.io/xenstore/#Xs_client_lwt:IO.backend" class="ocaml_internal">backend</a></code></pre>
<pre class="odoccode"><span class="TYPEchannel"><span class="keyword">type</span> channel</span></pre>
<pre class="odoccode"><span class="VALcreate"><span class="keyword">val</span> create</span> : <code class="type">unit -&gt; <a href="http://mirage.github.io/xenstore/#Xs_client_lwt:IO.channel" class="ocaml_internal">channel</a> <a href="http://mirage.github.io/xenstore/#Xs_client_lwt:IO.t" class="ocaml_internal">t</a></code></pre>
<pre class="odoccode"><span class="VALdestroy"><span class="keyword">val</span> destroy</span> : <code class="type"><a href="http://mirage.github.io/xenstore/#Xs_client_lwt:IO.channel" class="ocaml_internal">channel</a> -&gt; unit <a href="http://mirage.github.io/xenstore/#Xs_client_lwt:IO.t" class="ocaml_internal">t</a></code></pre>
<pre class="odoccode"><span class="VALread"><span class="keyword">val</span> read</span> : <code class="type"><a href="http://mirage.github.io/xenstore/#Xs_client_lwt:IO.channel" class="ocaml_internal">channel</a> -&gt; string -&gt; int -&gt; int -&gt; int <a href="http://mirage.github.io/xenstore/#Xs_client_lwt:IO.t" class="ocaml_internal">t</a></code></pre>
<pre class="odoccode"><span class="VALwrite"><span class="keyword">val</span> write</span> : <code class="type"><a href="http://mirage.github.io/xenstore/#Xs_client_lwt:IO.channel" class="ocaml_internal">channel</a> -&gt; string -&gt; int -&gt; int -&gt; unit <a href="http://mirage.github.io/xenstore/#Xs_client_lwt:IO.t" class="ocaml_internal">t</a></code></pre></div></div>
<pre class="odoccode"><span class="EXCEPTIONMalformed_watch_event"><span class="keyword">exception</span> Malformed_watch_event</span></pre>
<pre class="odoccode"><span class="EXCEPTIONUnexpected_rid"><span class="keyword">exception</span> Unexpected_rid</span> <span class="keyword">of</span> <code class="type">int32</code></pre>
<pre class="odoccode"><span class="EXCEPTIONDispatcher_failed"><span class="keyword">exception</span> Dispatcher_failed</span></pre>
<div class="ocaml_modtype" name="S"><pre class="odoccode"><span class="keyword">module type</span> <a href="http://mirage.github.io/xenstore/#Xs_client_lwt:S" class="ocaml_internal">S</a> = <code class="type"><code class="code">sig</code> .. <code class="code">end</code></code></pre><div class="ocaml_summary"/><div class="ocaml_content">
<pre class="odoccode"><span class="TYPEclient"><span class="keyword">type</span> client</span></pre><div class="info">A multiplexing xenstore client.</div>
<pre class="odoccode"><span class="VALmake"><span class="keyword">val</span> make</span> : <code class="type">unit -&gt; <a href="http://mirage.github.io/xenstore/#Xs_client_lwt:S.client" class="ocaml_internal">client</a> <a href="http://mirage.github.io/lwt/#Lwt.t">Lwt.t</a></code></pre><div class="info"><code class="code">make ()</code> initialises and returns a xenstore client.</div>
<pre class="odoccode"><span class="VALsuspend"><span class="keyword">val</span> suspend</span> : <code class="type"><a href="http://mirage.github.io/xenstore/#Xs_client_lwt:S.client" class="ocaml_internal">client</a> -&gt; unit <a href="http://mirage.github.io/lwt/#Lwt.t">Lwt.t</a></code></pre><div class="info"><code class="code">suspend ()</code> suspends the client, waiting for outstanding RPCs
to be completed, cancelling all watches and causing new requests
to be queued.</div>
<pre class="odoccode"><span class="VALresume"><span class="keyword">val</span> resume</span> : <code class="type"><a href="http://mirage.github.io/xenstore/#Xs_client_lwt:S.client" class="ocaml_internal">client</a> -&gt; unit <a href="http://mirage.github.io/lwt/#Lwt.t">Lwt.t</a></code></pre><div class="info"><code class="code">resume ()</code> resumes the client. The connection must be up and
running again before using this function.</div>
<pre class="odoccode"><span class="TYPEhandle"><span class="keyword">type</span> handle</span></pre><div class="info">A handle represents a single thread's xenstore access.</div>
<pre class="odoccode"><span class="VALimmediate"><span class="keyword">val</span> immediate</span> : <code class="type"><a href="http://mirage.github.io/xenstore/#Xs_client_lwt:S.client" class="ocaml_internal">client</a> -&gt; (<a href="http://mirage.github.io/xenstore/#Xs_client_lwt:S.handle" class="ocaml_internal">handle</a> -&gt; 'a <a href="http://mirage.github.io/lwt/#Lwt.t">Lwt.t</a>) -&gt; 'a <a href="http://mirage.github.io/lwt/#Lwt.t">Lwt.t</a></code></pre><div class="info">Access xenstore with individual operations.</div>
<pre class="odoccode"><span class="VALtransaction"><span class="keyword">val</span> transaction</span> : <code class="type"><a href="http://mirage.github.io/xenstore/#Xs_client_lwt:S.client" class="ocaml_internal">client</a> -&gt; (<a href="http://mirage.github.io/xenstore/#Xs_client_lwt:S.handle" class="ocaml_internal">handle</a> -&gt; 'a <a href="http://mirage.github.io/lwt/#Lwt.t">Lwt.t</a>) -&gt; 'a <a href="http://mirage.github.io/lwt/#Lwt.t">Lwt.t</a></code></pre><div class="info">Access xenstore with a single transaction.
On conflict the operation will be repeated.</div>
<pre class="odoccode"><span class="VALwait"><span class="keyword">val</span> wait</span> : <code class="type"><a href="http://mirage.github.io/xenstore/#Xs_client_lwt:S.client" class="ocaml_internal">client</a> -&gt; (<a href="http://mirage.github.io/xenstore/#Xs_client_lwt:S.handle" class="ocaml_internal">handle</a> -&gt; 'a <a href="http://mirage.github.io/lwt/#Lwt.t">Lwt.t</a>) -&gt; 'a <a href="http://mirage.github.io/lwt/#Lwt.t">Lwt.t</a></code></pre><div class="info">Wait for some condition to become true and return a value. The
function argument should throw Eagain if the condition is not
met, and the condition will be re-evaluated when paths
change.</div>
<pre class="odoccode"><span class="VALdirectory"><span class="keyword">val</span> directory</span> : <code class="type"><a href="http://mirage.github.io/xenstore/#Xs_client_lwt:S.handle" class="ocaml_internal">handle</a> -&gt; string -&gt; string list <a href="http://mirage.github.io/lwt/#Lwt.t">Lwt.t</a></code></pre><div class="info"><code class="code">directory h path</code> returns the directory listing of <code class="code">path</code>.</div>
<pre class="odoccode"><span class="VALread"><span class="keyword">val</span> read</span> : <code class="type"><a href="http://mirage.github.io/xenstore/#Xs_client_lwt:S.handle" class="ocaml_internal">handle</a> -&gt; string -&gt; string <a href="http://mirage.github.io/lwt/#Lwt.t">Lwt.t</a></code></pre><div class="info"><code class="code">read h path</code> returns the value at <code class="code">path</code> or raises Enoent.</div>
<pre class="odoccode"><span class="VALwrite"><span class="keyword">val</span> write</span> : <code class="type"><a href="http://mirage.github.io/xenstore/#Xs_client_lwt:S.handle" class="ocaml_internal">handle</a> -&gt; string -&gt; string -&gt; unit <a href="http://mirage.github.io/lwt/#Lwt.t">Lwt.t</a></code></pre><div class="info"><code class="code">write h k v</code> writes <code class="code">v</code> at <code class="code">k</code>.</div>
<pre class="odoccode"><span class="VALrm"><span class="keyword">val</span> rm</span> : <code class="type"><a href="http://mirage.github.io/xenstore/#Xs_client_lwt:S.handle" class="ocaml_internal">handle</a> -&gt; string -&gt; unit <a href="http://mirage.github.io/lwt/#Lwt.t">Lwt.t</a></code></pre><div class="info"><code class="code">rm h k</code> removes the node <code class="code">k</code>.</div>
<pre class="odoccode"><span class="VALmkdir"><span class="keyword">val</span> mkdir</span> : <code class="type"><a href="http://mirage.github.io/xenstore/#Xs_client_lwt:S.handle" class="ocaml_internal">handle</a> -&gt; string -&gt; unit <a href="http://mirage.github.io/lwt/#Lwt.t">Lwt.t</a></code></pre><div class="info"><code class="code">mkdir h k</code> creates the node <code class="code">k</code> with an empty value.</div>
<pre class="odoccode"><span class="VALsetperms"><span class="keyword">val</span> setperms</span> : <code class="type"><a href="http://mirage.github.io/xenstore/#Xs_client_lwt:S.handle" class="ocaml_internal">handle</a> -&gt; string -&gt; <a href="http://mirage.github.io/xenstore/#Xs_protocol.ACL.t">Xs_protocol.ACL.t</a> -&gt; unit <a href="http://mirage.github.io/lwt/#Lwt.t">Lwt.t</a></code></pre><div class="info"><code class="code">setperms h k acl</code> sets the permissions of <code class="code">k</code> to <code class="code">acl</code>.</div>
<pre class="odoccode"><span class="VALdebug"><span class="keyword">val</span> debug</span> : <code class="type"><a href="http://mirage.github.io/xenstore/#Xs_client_lwt:S.handle" class="ocaml_internal">handle</a> -&gt; string list -&gt; string list <a href="http://mirage.github.io/lwt/#Lwt.t">Lwt.t</a></code></pre><div class="info"><code class="code">debug cmd_args</code> invokes a debug command.</div>
<pre class="odoccode"><span class="VALrestrict"><span class="keyword">val</span> restrict</span> : <code class="type"><a href="http://mirage.github.io/xenstore/#Xs_client_lwt:S.handle" class="ocaml_internal">handle</a> -&gt; int -&gt; unit <a href="http://mirage.github.io/lwt/#Lwt.t">Lwt.t</a></code></pre><div class="info"><code class="code">restrict h domid</code> restricts the current connection to have only
the priviledges associated with domain <code class="code">domid</code>.</div>
<pre class="odoccode"><span class="VALgetdomainpath"><span class="keyword">val</span> getdomainpath</span> : <code class="type"><a href="http://mirage.github.io/xenstore/#Xs_client_lwt:S.handle" class="ocaml_internal">handle</a> -&gt; int -&gt; string <a href="http://mirage.github.io/lwt/#Lwt.t">Lwt.t</a></code></pre><div class="info"><code class="code">getdomainpath domid</code> returns the local directory of domain
<code class="code">domid</code>.</div>
<pre class="odoccode"><span class="VALwatch"><span class="keyword">val</span> watch</span> : <code class="type"><a href="http://mirage.github.io/xenstore/#Xs_client_lwt:S.handle" class="ocaml_internal">handle</a> -&gt; string -&gt; <a href="http://mirage.github.io/xenstore/#Xs_protocol.Token.t">Xs_protocol.Token.t</a> -&gt; unit <a href="http://mirage.github.io/lwt/#Lwt.t">Lwt.t</a></code></pre><div class="info"><code class="code">watch h path token</code> registers a manual watch at <code class="code">path</code> with
<code class="code">token</code>.</div>
<pre class="odoccode"><span class="VALunwatch"><span class="keyword">val</span> unwatch</span> : <code class="type"><a href="http://mirage.github.io/xenstore/#Xs_client_lwt:S.handle" class="ocaml_internal">handle</a> -&gt; string -&gt; <a href="http://mirage.github.io/xenstore/#Xs_protocol.Token.t">Xs_protocol.Token.t</a> -&gt; unit <a href="http://mirage.github.io/lwt/#Lwt.t">Lwt.t</a></code></pre><div class="info"><code class="code">unwatch h path token</code> unregisters a manual watch at <code class="code">path</code> with
<code class="code">token</code>.</div>
<pre class="odoccode"><span class="VALintroduce"><span class="keyword">val</span> introduce</span> : <code class="type"><a href="http://mirage.github.io/xenstore/#Xs_client_lwt:S.handle" class="ocaml_internal">handle</a> -&gt; int -&gt; nativeint -&gt; int -&gt; unit <a href="http://mirage.github.io/lwt/#Lwt.t">Lwt.t</a></code></pre><div class="info"><code class="code">introduce h domid store_mfn store_port</code> called by a toolstack
to signal the construction of a new domain.</div>
<pre class="odoccode"><span class="VALset_target"><span class="keyword">val</span> set_target</span> : <code class="type"><a href="http://mirage.github.io/xenstore/#Xs_client_lwt:S.handle" class="ocaml_internal">handle</a> -&gt; int -&gt; int -&gt; unit <a href="http://mirage.github.io/lwt/#Lwt.t">Lwt.t</a></code></pre><div class="info"><code class="code">set_target h stubdom_domid domid</code> called by a toolstack to grant
<code class="code">stubdom_domid</code> the permissions owned by <code class="code">domid</code>.</div></div></div>
<div class="ocaml_module" name="Client" path="http://mirage.github.io/xenstore/#Xs_client_lwt:S"><pre class="odoccode"><span class="keyword">module</span> <a href="http://mirage.github.io/xenstore/#Xs_client_lwt.Client" class="ocaml_internal">Client</a> : <code class="type"><div class="sig_block"><code class="code">functor (</code><code class="code">IO</code><code class="code"> : </code><code class="code"><a href="http://mirage.github.io/xenstore/#Xs_client_lwt:IO" class="ocaml_internal">IO</a></code><code class="code">) -&gt; </code><code class="code"><a href="http://mirage.github.io/xenstore/#Xs_client_lwt:S" class="ocaml_internal">S</a></code></div></code></pre><div class="ocaml_summary"/></div>
</div></div>