<div class="ocaml_top"><div class="ocaml_summary"><div class="info">The point of <code class="code">Benchmark_accumulator</code> is to provide a global place where inline
benchmarking macros can register themselves. Once registered here, the benchmarks are
retrieved and analyzed using <code class="code">Core_bench</code>.<p>This module holds the registered benchmarks in a global hashtable indexed by library
name. We care about the registered benchmarks if and only if the library is being
used in a <code class="code">inline_benchmarks_runner.exe</code>. To avoid building this hashtable in cases
where we will not use it, this module peeks into the commandline args of the running
program to decide if the benchmarks should be registered or not.</p></div></div>
<div class="ocaml_content"><div class="ocaml_module" name="Current_libname"><pre class="odoccode"><span class="keyword">module</span> <a href="http://mirage.github.io/pa_bench/#Benchmark_accumulator.Current_libname" class="ocaml_internal">Current_libname</a> : <code class="type"><code class="code">sig</code> .. <code class="code">end</code></code></pre><div class="ocaml_summary"/><div class="ocaml_content">
<pre class="odoccode"><span class="VALset"><span class="keyword">val</span> set</span> : <code class="type">string -&gt; unit</code></pre>
<pre class="odoccode"><span class="VALunset"><span class="keyword">val</span> unset</span> : <code class="type">unit -&gt; unit</code></pre></div></div>
<div class="ocaml_module" name="Entry"><pre class="odoccode"><span class="keyword">module</span> <a href="http://mirage.github.io/pa_bench/#Benchmark_accumulator.Entry" class="ocaml_internal">Entry</a> : <code class="type"><code class="code">sig</code> .. <code class="code">end</code></code></pre><div class="ocaml_summary"/><div class="ocaml_content">
<pre class="odoccode"><code><span class="TYPEindexed_spec"><span class="keyword">type</span> indexed_spec</span> = {</code></pre><table class="typetable">
		    <tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTindexed_spec.arg_name">arg_name</span> : <code class="type">string</code>;</code></td></tr><tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTindexed_spec.arg_values">arg_values</span> : <code class="type">int list</code>;</code></td></tr><tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTindexed_spec.thunk">thunk</span> : <code class="type">int -&gt; unit -&gt; unit</code>;</code></td></tr><tr><td>}</td></tr></table>
<pre class="odoccode"><code><span class="TYPEtest_spec"><span class="keyword">type</span> test_spec</span> = </code></pre><table class="typetable">
		    <tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTtest_spec.Regular_thunk"><span class="constructor">Regular_thunk</span></span> <span class="keyword">of</span> <code class="type">unit -&gt; unit -&gt; unit</code></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTtest_spec.Indexed_thunk"><span class="constructor">Indexed_thunk</span></span> <span class="keyword">of</span> <code class="type"><a href="http://mirage.github.io/pa_bench/#Benchmark_accumulator.Entry.indexed_spec" class="ocaml_internal">indexed_spec</a></code></code></td></tr></table>
<pre class="odoccode"><code><span class="TYPEt"><span class="keyword">type</span> t</span> = <span class="keyword">private</span> {</code></pre><table class="typetable">
		    <tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTt.unique_id">unique_id</span> : <code class="type">int</code>;</code></td></tr><tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTt.code">code</span> : <code class="type">string</code>;</code></td></tr><tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTt.type_conv_path">type_conv_path</span> : <code class="type">string</code>;</code></td></tr><tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTt.name">name</span> : <code class="type">string</code>;</code></td></tr><tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTt.filename">filename</span> : <code class="type">string</code>;</code></td></tr><tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTt.line">line</span> : <code class="type">int</code>;</code></td></tr><tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTt.startpos">startpos</span> : <code class="type">int</code>;</code></td></tr><tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTt.endpos">endpos</span> : <code class="type">int</code>;</code></td></tr><tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTt.test_spec">test_spec</span> : <code class="type"><a href="http://mirage.github.io/pa_bench/#Benchmark_accumulator.Entry.test_spec" class="ocaml_internal">test_spec</a></code>;</code></td></tr><tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTt.bench_module_name">bench_module_name</span> : <code class="type">string option</code>;</code></td></tr><tr><td>}</td></tr></table>
<pre class="odoccode"><span class="VALcompare"><span class="keyword">val</span> compare</span> : <code class="type"><a href="http://mirage.github.io/pa_bench/#Benchmark_accumulator.Entry.t" class="ocaml_internal">t</a> -&gt; <a href="http://mirage.github.io/pa_bench/#Benchmark_accumulator.Entry.t" class="ocaml_internal">t</a> -&gt; int</code></pre>
<pre class="odoccode"><span class="VALget_indexed_arg_name"><span class="keyword">val</span> get_indexed_arg_name</span> : <code class="type"><a href="http://mirage.github.io/pa_bench/#Benchmark_accumulator.Entry.t" class="ocaml_internal">t</a> -&gt; string option</code></pre>
<pre class="odoccode"><span class="VALget_module_name_opt"><span class="keyword">val</span> get_module_name_opt</span> : <code class="type"><a href="http://mirage.github.io/pa_bench/#Benchmark_accumulator.Entry.t" class="ocaml_internal">t</a> -&gt; string option</code></pre></div></div>
<pre class="odoccode"><span class="VALadd_benchmarks_flag"><span class="keyword">val</span> add_benchmarks_flag</span> : <code class="type">bool</code></pre><div class="info"><code class="code">add_benchmarks_flag</code> returns true if the benchmarks should be added to the
hashtable</div>
<pre class="odoccode"><span class="VALlookup_lib"><span class="keyword">val</span> lookup_lib</span> : <code class="type">libname:string -&gt; <a href="http://mirage.github.io/pa_bench/#Benchmark_accumulator.Entry.t" class="ocaml_internal">Entry.t</a> list</code></pre><div class="info"><code class="code">lookup_lib</code> returns all the benchmarks from the specified library</div>
<pre class="odoccode"><span class="VALadd_bench"><span class="keyword">val</span> add_bench</span> : <code class="type">name:string -&gt;
code:string -&gt;
filename:string -&gt;
type_conv_path:string -&gt;
line:int -&gt; startpos:int -&gt; endpos:int -&gt; <a href="http://mirage.github.io/pa_bench/#Benchmark_accumulator.Entry.test_spec" class="ocaml_internal">Entry.test_spec</a> -&gt; unit</code></pre><div class="info"><code class="code">add_bench</code> registers benchmarks with the global hashtable maintained in
<code class="code">pa_bench_lib</code>. This is meant to be called by the code generated for the BENCH and
BENCH_INDEXED macros</div>
<pre class="odoccode"><span class="VALadd_bench_module"><span class="keyword">val</span> add_bench_module</span> : <code class="type">name:string -&gt;
code:string -&gt;
type_conv_path:string -&gt;
filename:string -&gt;
line:int -&gt; startpos:int -&gt; endpos:int -&gt; (unit -&gt; unit) -&gt; unit</code></pre><div class="info"><code class="code">add_bench_module</code> adds a bench module name to the benchmarks. This is called by
BENCH_MODULE macro</div>
</div></div>