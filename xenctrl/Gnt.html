<div class="ocaml_top"><div class="ocaml_summary"><div class="info">Grant tables interface.</div></div>
<div class="ocaml_content"><pre class="odoccode"><span class="TYPEbuf"><span class="keyword">type</span> buf</span> = <code class="type">(char, Bigarray.int8_unsigned_elt, Bigarray.c_layout) Bigarray.Array1.t</code></pre>
<pre class="odoccode"><span class="TYPEgntref"><span class="keyword">type</span> gntref</span> = <code class="type">int</code></pre><div class="info">Type of a grant table index, called a grant reference in
Xen's terminology.</div>
<div class="ocaml_module" name="Gnttab"><pre class="odoccode"><span class="keyword">module</span> <a href="http://mirage.github.io/xenctrl/#Gnt.Gnttab" class="ocaml_internal">Gnttab</a> : <code class="type"><code class="code">sig</code> .. <code class="code">end</code></code></pre><div class="ocaml_summary"/><div class="ocaml_content">
<pre class="odoccode"><span class="TYPEinterface"><span class="keyword">type</span> interface</span></pre><div class="info">A connection to the grant device, needed for mapping/unmapping</div>
<pre class="odoccode"><span class="VALinterface_open"><span class="keyword">val</span> interface_open</span> : <code class="type">unit -&gt; <a href="http://mirage.github.io/xenctrl/#Gnt.Gnttab.interface" class="ocaml_internal">interface</a></code></pre><div class="info">Open a connection to the grant device. This must be done before any
calls to map or unmap.</div>
<pre class="odoccode"><span class="VALinterface_close"><span class="keyword">val</span> interface_close</span> : <code class="type"><a href="http://mirage.github.io/xenctrl/#Gnt.Gnttab.interface" class="ocaml_internal">interface</a> -&gt; unit</code></pre><div class="info">Close a connection to the grant device. Any future calls to map or
unmap will fail.</div>
<pre class="odoccode"><code><span class="TYPEgrant"><span class="keyword">type</span> grant</span> = {</code></pre><table class="typetable">
		    <tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTgrant.domid">domid</span> : <code class="type">int</code>;</code></td><td class="typefieldcomment" align="left"><div class="info">foreign domain who is exporting memory</div></td></tr><tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTgrant.ref">ref</span> : <code class="type"><a href="http://mirage.github.io/xenctrl/#Gnt.gntref" class="ocaml_internal">gntref</a></code>;</code></td><td class="typefieldcomment" align="left"><div class="info">id which identifies the specific export in the foreign domain</div></td></tr><tr><td>}</td></tr></table><div class="info">A foreign domain must explicitly &quot;grant&quot; us memory and send us the
&quot;reference&quot;. The pair of (foreign domain id, reference) uniquely
identifies the block of memory. This pair (&quot;grant&quot;) is transmitted
to us out-of-band, usually either via xenstore during device setup or
via a shared memory ring structure.</div>
<div class="ocaml_module" name="Local_mapping"><pre class="odoccode"><span class="keyword">module</span> <a href="http://mirage.github.io/xenctrl/#Gnt.Gnttab.Local_mapping" class="ocaml_internal">Local_mapping</a> : <code class="type"><code class="code">sig</code> .. <code class="code">end</code></code></pre><div class="ocaml_summary"/><div class="ocaml_content">
<pre class="odoccode"><span class="TYPEt"><span class="keyword">type</span> t</span></pre><div class="info">Abstract type representing a locally-mapped shared memory page</div>
<pre class="odoccode"><span class="VALto_buf"><span class="keyword">val</span> to_buf</span> : <code class="type"><a href="http://mirage.github.io/xenctrl/#Gnt.Gnttab.Local_mapping.t" class="ocaml_internal">t</a> -&gt; <a href="http://mirage.github.io/xenctrl/#Gnt.buf" class="ocaml_internal">buf</a></code></pre></div></div>
<pre class="odoccode"><span class="VALmap_exn"><span class="keyword">val</span> map_exn</span> : <code class="type"><a href="http://mirage.github.io/xenctrl/#Gnt.Gnttab.interface" class="ocaml_internal">interface</a> -&gt; <a href="http://mirage.github.io/xenctrl/#Gnt.Gnttab.grant" class="ocaml_internal">grant</a> -&gt; bool -&gt; <a href="http://mirage.github.io/xenctrl/#Gnt.Gnttab.Local_mapping.t" class="ocaml_internal">Local_mapping.t</a></code></pre><div class="info"><code class="code">map_exn if grant writable</code> creates a single mapping from
<code class="code">grant</code> that will be writable if <code class="code">writable</code> is <code class="code">true</code>.</div>
<pre class="odoccode"><span class="VALmap"><span class="keyword">val</span> map</span> : <code class="type"><a href="http://mirage.github.io/xenctrl/#Gnt.Gnttab.interface" class="ocaml_internal">interface</a> -&gt; <a href="http://mirage.github.io/xenctrl/#Gnt.Gnttab.grant" class="ocaml_internal">grant</a> -&gt; bool -&gt; <a href="http://mirage.github.io/xenctrl/#Gnt.Gnttab.Local_mapping.t" class="ocaml_internal">Local_mapping.t</a> option</code></pre><div class="info">Like the above but wraps the result in an option instead of
raising an exception.</div>
<pre class="odoccode"><span class="VALmapv_exn"><span class="keyword">val</span> mapv_exn</span> : <code class="type"><a href="http://mirage.github.io/xenctrl/#Gnt.Gnttab.interface" class="ocaml_internal">interface</a> -&gt; <a href="http://mirage.github.io/xenctrl/#Gnt.Gnttab.grant" class="ocaml_internal">grant</a> list -&gt; bool -&gt; <a href="http://mirage.github.io/xenctrl/#Gnt.Gnttab.Local_mapping.t" class="ocaml_internal">Local_mapping.t</a></code></pre><div class="info"><code class="code">mapv if grants writable</code> creates a single contiguous mapping
from a list of grants that will be writable if <code class="code">writable</code> is
<code class="code">true</code>. Note the grant list can involve grants from multiple
domains.</div>
<pre class="odoccode"><span class="VALmapv"><span class="keyword">val</span> mapv</span> : <code class="type"><a href="http://mirage.github.io/xenctrl/#Gnt.Gnttab.interface" class="ocaml_internal">interface</a> -&gt; <a href="http://mirage.github.io/xenctrl/#Gnt.Gnttab.grant" class="ocaml_internal">grant</a> list -&gt; bool -&gt; <a href="http://mirage.github.io/xenctrl/#Gnt.Gnttab.Local_mapping.t" class="ocaml_internal">Local_mapping.t</a> option</code></pre><div class="info">Like the above but wraps the result in an option instead of
raising an exception.</div>
<pre class="odoccode"><span class="VALunmap_exn"><span class="keyword">val</span> unmap_exn</span> : <code class="type"><a href="http://mirage.github.io/xenctrl/#Gnt.Gnttab.interface" class="ocaml_internal">interface</a> -&gt; <a href="http://mirage.github.io/xenctrl/#Gnt.Gnttab.Local_mapping.t" class="ocaml_internal">Local_mapping.t</a> -&gt; unit</code></pre><div class="info">Unmap a single mapping (which may involve multiple grants)</div></div></div>
<div class="ocaml_module" name="Gntshr"><pre class="odoccode"><span class="keyword">module</span> <a href="http://mirage.github.io/xenctrl/#Gnt.Gntshr" class="ocaml_internal">Gntshr</a> : <code class="type"><code class="code">sig</code> .. <code class="code">end</code></code></pre><div class="ocaml_summary"/><div class="ocaml_content">
<pre class="odoccode"><span class="TYPEinterface"><span class="keyword">type</span> interface</span></pre><div class="info">A connection to the gntshr device, needed for sharing/unmapping</div>
<pre class="odoccode"><span class="VALinterface_open"><span class="keyword">val</span> interface_open</span> : <code class="type">unit -&gt; <a href="http://mirage.github.io/xenctrl/#Gnt.Gntshr.interface" class="ocaml_internal">interface</a></code></pre><div class="info">Open a connection to the gntshr device. This must be done before any
calls to share or unmap.</div>
<pre class="odoccode"><span class="VALinterface_close"><span class="keyword">val</span> interface_close</span> : <code class="type"><a href="http://mirage.github.io/xenctrl/#Gnt.Gntshr.interface" class="ocaml_internal">interface</a> -&gt; unit</code></pre><div class="info">Close a connection to the gntshr device. Any future calls to share or
unmap will fail.</div>
<pre class="odoccode"><code><span class="TYPEshare"><span class="keyword">type</span> share</span> = {</code></pre><table class="typetable">
		    <tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTshare.refs">refs</span> : <code class="type"><a href="http://mirage.github.io/xenctrl/#Gnt.gntref" class="ocaml_internal">gntref</a> list</code>;</code></td><td class="typefieldcomment" align="left"><div class="info">List of grant references which have been shared with a foreign domain.</div></td></tr><tr><td align="left" valign="top"><code>  </code></td><td align="left" valign="top"><code><span class="TYPEELTshare.mapping">mapping</span> : <code class="type"><a href="http://mirage.github.io/xenctrl/#Gnt.buf" class="ocaml_internal">buf</a></code>;</code></td><td class="typefieldcomment" align="left"><div class="info">Mapping of the shared memory.</div></td></tr><tr><td>}</td></tr></table><div class="info">When sharing a number of pages with another domain, we receive back both the
list of grant references shared and actually mapped page(s). The foreign
domain can map the same shared memory, after being notified (e.g. via xenstore)
of our domid and list of references.</div>
<pre class="odoccode"><span class="VALshare_pages_exn"><span class="keyword">val</span> share_pages_exn</span> : <code class="type"><a href="http://mirage.github.io/xenctrl/#Gnt.Gntshr.interface" class="ocaml_internal">interface</a> -&gt; int -&gt; int -&gt; bool -&gt; <a href="http://mirage.github.io/xenctrl/#Gnt.Gntshr.share" class="ocaml_internal">share</a></code></pre><div class="info"><code class="code">share_pages_exn if domid count writeable</code> shares <code class="code">count</code> pages with foreign
domain <code class="code">domid</code>. <code class="code">writeable</code> determines whether or not the foreign domain can
write to the shared memory.</div>
<pre class="odoccode"><span class="VALshare_pages"><span class="keyword">val</span> share_pages</span> : <code class="type"><a href="http://mirage.github.io/xenctrl/#Gnt.Gntshr.interface" class="ocaml_internal">interface</a> -&gt; int -&gt; int -&gt; bool -&gt; <a href="http://mirage.github.io/xenctrl/#Gnt.Gntshr.share" class="ocaml_internal">share</a> option</code></pre><div class="info"><code class="code">share_pages if domid count writeable</code> shares <code class="code">count</code> pages with foreign domain
<code class="code">domid</code>. <code class="code">writeable</code> determines whether or not the foreign domain can write to
the shared memory.
On error this function returns None. Diagnostic details will be logged.</div>
<pre class="odoccode"><span class="VALmunmap_exn"><span class="keyword">val</span> munmap_exn</span> : <code class="type"><a href="http://mirage.github.io/xenctrl/#Gnt.Gntshr.interface" class="ocaml_internal">interface</a> -&gt; <a href="http://mirage.github.io/xenctrl/#Gnt.Gntshr.share" class="ocaml_internal">share</a> -&gt; unit</code></pre><div class="info">Unmap a single mapping (which may involve multiple grants)</div>
<pre class="odoccode"><span class="VALget_n"><span class="keyword">val</span> get_n</span> : <code class="type">int -&gt; <a href="http://mirage.github.io/xenctrl/#Gnt.gntref" class="ocaml_internal">gntref</a> list <a href="http://mirage.github.io/lwt/#Lwt.t">Lwt.t</a></code></pre><div class="info">Allocate a block of n grant table indices</div></div></div>
</div></div>