<div class="ocaml_top"><div class="ocaml_summary"><div class="info">Shared ring handling to communicate with other Xen domains.</div></div>
<div class="ocaml_content"><pre class="odoccode"><span class="TYPEbuf"><span class="keyword">type</span> buf</span> = <code class="type"><a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a></code></pre>
<div class="ocaml_module" name="Rpc"><pre class="odoccode"><span class="keyword">module</span> <a href="http://mirage.github.io/shared-memory-ring/#Ring.Rpc" class="ocaml_internal">Rpc</a> : <code class="type"><code class="code">sig</code> .. <code class="code">end</code></code></pre><div class="ocaml_summary"/><div class="ocaml_content">
<pre class="odoccode"><span class="TYPEsring"><span class="keyword">type</span> sring</span></pre><div class="info">Abstract type for a shared ring.</div>
<pre class="odoccode"><span class="VALof_buf"><span class="keyword">val</span> of_buf</span> : <code class="type">buf:<a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a> -&gt; idx_size:int -&gt; name:string -&gt; <a href="http://mirage.github.io/shared-memory-ring/#Ring.Rpc.sring" class="ocaml_internal">sring</a></code></pre><div class="info"><code class="code">of_buf ~buf ~idx_size ~name</code> is an <code class="code">sring</code> constructed from
<code class="code">buf</code>, of maximum request/response size <code class="code">idx_size</code>. <code class="code">name</code> is used for
pretty-printing. <code class="code">buf</code> should be a Cstruct.t comprising pre-allocated
contiguous I/O pages.</div>
<pre class="odoccode"><span class="VALto_summary_string"><span class="keyword">val</span> to_summary_string</span> : <code class="type"><a href="http://mirage.github.io/shared-memory-ring/#Ring.Rpc.sring" class="ocaml_internal">sring</a> -&gt; string</code></pre><div class="info"><code class="code">to_summary_string ring</code> is a printable single-line summary of the
ring.</div>
<div class="ocaml_module" name="Front"><pre class="odoccode"><span class="keyword">module</span> <a href="http://mirage.github.io/shared-memory-ring/#Ring.Rpc.Front" class="ocaml_internal">Front</a> : <code class="type"><code class="code">sig</code> .. <code class="code">end</code></code></pre><div class="ocaml_summary"><div class="info">The front-end of the shared ring, which reads requests and reads
responses from the remote domain.</div></div><div class="ocaml_content">
<pre class="odoccode"><span class="TYPEt"><span class="keyword">type</span> <code class="type">('a, 'b) </code>t</span></pre><div class="info">Type of a frontend. 'a is the response type, and 'b is the
request id type (e.g. int or int64).</div>
<pre class="odoccode"><span class="VALinit"><span class="keyword">val</span> init</span> : <code class="type">sring:<a href="http://mirage.github.io/shared-memory-ring/#Ring.Rpc.sring" class="ocaml_internal">sring</a> -&gt; ('a, 'b) <a href="http://mirage.github.io/shared-memory-ring/#Ring.Rpc.Front.t" class="ocaml_internal">t</a></code></pre><div class="info"><code class="code">init ~sring</code> is an initialized frontend attached to shared ring
<code class="code">sring</code>.</div>
<pre class="odoccode"><span class="VALslot"><span class="keyword">val</span> slot</span> : <code class="type">('a, 'b) <a href="http://mirage.github.io/shared-memory-ring/#Ring.Rpc.Front.t" class="ocaml_internal">t</a> -&gt; int -&gt; <a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a></code></pre><div class="info"><code class="code">slot frontend idx</code> retrieves the request/response slot at <code class="code">idx</code>
as an Cstruct.t. <code class="code">idx</code> should be less than <code class="code">nr_ents</code>.</div>
<pre class="odoccode"><span class="VALnr_ents"><span class="keyword">val</span> nr_ents</span> : <code class="type">('a, 'b) <a href="http://mirage.github.io/shared-memory-ring/#Ring.Rpc.Front.t" class="ocaml_internal">t</a> -&gt; int</code></pre><div class="info"><code class="code">nr_ents frontend</code> is the number of slots in the underlying
shared ring.</div>
<pre class="odoccode"><span class="VALget_free_requests"><span class="keyword">val</span> get_free_requests</span> : <code class="type">('a, 'b) <a href="http://mirage.github.io/shared-memory-ring/#Ring.Rpc.Front.t" class="ocaml_internal">t</a> -&gt; int</code></pre><div class="info"><code class="code">get_free_requests frontend</code> is the number of free request slots
remaining in <code class="code">frontend</code>.</div>
<pre class="odoccode"><span class="VALnext_req_id"><span class="keyword">val</span> next_req_id</span> : <code class="type">('a, 'b) <a href="http://mirage.github.io/shared-memory-ring/#Ring.Rpc.Front.t" class="ocaml_internal">t</a> -&gt; int</code></pre><div class="info"><code class="code">next_req_id frontend</code> advances the ring request producer and
returns the latest slot id.</div>
<pre class="odoccode"><span class="VALack_responses"><span class="keyword">val</span> ack_responses</span> : <code class="type">('a, 'b) <a href="http://mirage.github.io/shared-memory-ring/#Ring.Rpc.Front.t" class="ocaml_internal">t</a> -&gt; (<a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a> -&gt; unit) -&gt; unit</code></pre><div class="info"><code class="code">ack_response frontend f</code> reads all the outstanding responses
from the remote domain, calling <code class="code">f</code> on them, and updating the
response consumer pointer after each individual slot has been
processed.<p>This is the low-level function which is only used if some sort
of batching of requests is being performed, and normally you
should use the flow-controlled <code class="code">poll</code> that will ack the
responses and wake up any sleeping threads that were waiting for
that particular response.</p></div>
<pre class="odoccode"><span class="VALpush_requests"><span class="keyword">val</span> push_requests</span> : <code class="type">('a, 'b) <a href="http://mirage.github.io/shared-memory-ring/#Ring.Rpc.Front.t" class="ocaml_internal">t</a> -&gt; unit</code></pre><div class="info"><code class="code">push_requests frontend</code> updates the shared request producer.</div>
<pre class="odoccode"><span class="VALpush_requests_and_check_notify"><span class="keyword">val</span> push_requests_and_check_notify</span> : <code class="type">('a, 'b) <a href="http://mirage.github.io/shared-memory-ring/#Ring.Rpc.Front.t" class="ocaml_internal">t</a> -&gt; bool</code></pre><div class="info"><code class="code">push_requests_and_check_notify frontend</code> updates the shared
request producer, and returns <code class="code">true</code> if an event notification is
required to wake up the remote domain.</div>
<pre class="odoccode"><span class="VALto_string"><span class="keyword">val</span> to_string</span> : <code class="type">('a, 'b) <a href="http://mirage.github.io/shared-memory-ring/#Ring.Rpc.Front.t" class="ocaml_internal">t</a> -&gt; string</code></pre><div class="info"><code class="code">to_string t</code> pretty-prints ring metadata</div></div></div>
<div class="ocaml_module" name="Back"><pre class="odoccode"><span class="keyword">module</span> <a href="http://mirage.github.io/shared-memory-ring/#Ring.Rpc.Back" class="ocaml_internal">Back</a> : <code class="type"><code class="code">sig</code> .. <code class="code">end</code></code></pre><div class="ocaml_summary"><div class="info">The back-end of the shared ring, which reads requests and writes
responses to the remote domain.</div></div><div class="ocaml_content">
<pre class="odoccode"><span class="TYPEt"><span class="keyword">type</span> <code class="type">('a, 'b) </code>t</span></pre><div class="info">Type of a backend. 'a is the response type, and 'b is the
request id type (e.g. int or int64).</div>
<pre class="odoccode"><span class="VALinit"><span class="keyword">val</span> init</span> : <code class="type">sring:<a href="http://mirage.github.io/shared-memory-ring/#Ring.Rpc.sring" class="ocaml_internal">sring</a> -&gt; ('a, 'b) <a href="http://mirage.github.io/shared-memory-ring/#Ring.Rpc.Back.t" class="ocaml_internal">t</a></code></pre><div class="info"><code class="code">init ~sring</code> is an initialized backend attached to shared ring
<code class="code">sring</code>.</div>
<pre class="odoccode"><span class="VALslot"><span class="keyword">val</span> slot</span> : <code class="type">('a, 'b) <a href="http://mirage.github.io/shared-memory-ring/#Ring.Rpc.Back.t" class="ocaml_internal">t</a> -&gt; int -&gt; <a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a></code></pre><div class="info"><code class="code">slot backend idx</code> retrieves the request/response slot at <code class="code">idx</code>
as an Cstruct.t. <code class="code">idx</code> should be less than <code class="code">nr_ents</code>.</div>
<pre class="odoccode"><span class="VALnr_ents"><span class="keyword">val</span> nr_ents</span> : <code class="type">('a, 'b) <a href="http://mirage.github.io/shared-memory-ring/#Ring.Rpc.Back.t" class="ocaml_internal">t</a> -&gt; int</code></pre><div class="info"><code class="code">nr_ents backend</code> is the number of slots in the underlying
shared ring.</div>
<pre class="odoccode"><span class="VALnext_res_id"><span class="keyword">val</span> next_res_id</span> : <code class="type">('a, 'b) <a href="http://mirage.github.io/shared-memory-ring/#Ring.Rpc.Back.t" class="ocaml_internal">t</a> -&gt; int</code></pre><div class="info"><code class="code">next_res_id backend</code> advances the response producer and return the
latest slot id.</div>
<pre class="odoccode"><span class="VALpush_responses"><span class="keyword">val</span> push_responses</span> : <code class="type">('a, 'b) <a href="http://mirage.github.io/shared-memory-ring/#Ring.Rpc.Back.t" class="ocaml_internal">t</a> -&gt; unit</code></pre><div class="info"><code class="code">push_responses backend</code> updates the shared response producer.</div>
<pre class="odoccode"><span class="VALpush_responses_and_check_notify"><span class="keyword">val</span> push_responses_and_check_notify</span> : <code class="type">('a, 'b) <a href="http://mirage.github.io/shared-memory-ring/#Ring.Rpc.Back.t" class="ocaml_internal">t</a> -&gt; bool</code></pre><div class="info"><code class="code">push_responses_and_check_notify backend</code> updates the shared
response producer, and returns <code class="code">true</code> if an event notification
is required to wake up the remote domain.</div>
<pre class="odoccode"><span class="VALmore_to_do"><span class="keyword">val</span> more_to_do</span> : <code class="type">('a, 'b) <a href="http://mirage.github.io/shared-memory-ring/#Ring.Rpc.Back.t" class="ocaml_internal">t</a> -&gt; bool</code></pre><div class="info"><code class="code">more_to_do backend</code> returns <code class="code">true</code> if there are outstanding
requests on the ring which we should immediately process without
waiting for an event notification.</div>
<pre class="odoccode"><span class="VALack_requests"><span class="keyword">val</span> ack_requests</span> : <code class="type">('a, 'b) <a href="http://mirage.github.io/shared-memory-ring/#Ring.Rpc.Back.t" class="ocaml_internal">t</a> -&gt; (<a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a> -&gt; unit) -&gt; unit</code></pre><div class="info"><code class="code">ack_requests t fn</code> applies <code class="code">fn slot</code> to each <code class="code">slot</code> containing
a new request.</div>
<pre class="odoccode"><span class="VALto_string"><span class="keyword">val</span> to_string</span> : <code class="type">('a, 'b) <a href="http://mirage.github.io/shared-memory-ring/#Ring.Rpc.Back.t" class="ocaml_internal">t</a> -&gt; string</code></pre><div class="info"><code class="code">to_string backend</code> pretty-prints the ring metadata.</div></div></div></div></div>
<div class="ocaml_modtype" name="RW"><pre class="odoccode"><span class="keyword">module type</span> <a href="http://mirage.github.io/shared-memory-ring/#Ring:RW" class="ocaml_internal">RW</a> = <code class="type"><code class="code">sig</code> .. <code class="code">end</code></code></pre><div class="ocaml_summary"/><div class="ocaml_content">
<pre class="odoccode"><span class="VALget_ring_input"><span class="keyword">val</span> get_ring_input</span> : <code class="type"><a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a> -&gt; <a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a></code></pre><div class="info">A bi-directional pipe where 'input' and 'output' are from
the frontend's (i.e. the guest's) point of view</div>
<pre class="odoccode"><span class="VALget_ring_input_cons"><span class="keyword">val</span> get_ring_input_cons</span> : <code class="type"><a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a> -&gt; int32</code></pre>
<pre class="odoccode"><span class="VALget_ring_input_prod"><span class="keyword">val</span> get_ring_input_prod</span> : <code class="type"><a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a> -&gt; int32</code></pre>
<pre class="odoccode"><span class="VALset_ring_input_cons"><span class="keyword">val</span> set_ring_input_cons</span> : <code class="type"><a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a> -&gt; int32 -&gt; unit</code></pre>
<pre class="odoccode"><span class="VALset_ring_input_prod"><span class="keyword">val</span> set_ring_input_prod</span> : <code class="type"><a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a> -&gt; int32 -&gt; unit</code></pre>
<pre class="odoccode"><span class="VALget_ring_output"><span class="keyword">val</span> get_ring_output</span> : <code class="type"><a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a> -&gt; <a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a></code></pre>
<pre class="odoccode"><span class="VALget_ring_output_cons"><span class="keyword">val</span> get_ring_output_cons</span> : <code class="type"><a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a> -&gt; int32</code></pre>
<pre class="odoccode"><span class="VALget_ring_output_prod"><span class="keyword">val</span> get_ring_output_prod</span> : <code class="type"><a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a> -&gt; int32</code></pre>
<pre class="odoccode"><span class="VALset_ring_output_cons"><span class="keyword">val</span> set_ring_output_cons</span> : <code class="type"><a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a> -&gt; int32 -&gt; unit</code></pre>
<pre class="odoccode"><span class="VALset_ring_output_prod"><span class="keyword">val</span> set_ring_output_prod</span> : <code class="type"><a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a> -&gt; int32 -&gt; unit</code></pre></div></div>
<div class="ocaml_module" name="Reverse" path="http://mirage.github.io/shared-memory-ring/#Ring:RW"><pre class="odoccode"><span class="keyword">module</span> <a href="http://mirage.github.io/shared-memory-ring/#Ring.Reverse" class="ocaml_internal">Reverse</a> : <code class="type"><div class="sig_block"><code class="code">functor (</code><code class="code">RW</code><code class="code"> : </code><code class="code"><a href="http://mirage.github.io/shared-memory-ring/#Ring:RW" class="ocaml_internal">RW</a></code><code class="code">) -&gt; </code><code class="code"><a href="http://mirage.github.io/shared-memory-ring/#Ring:RW" class="ocaml_internal">RW</a></code></div></code></pre><div class="ocaml_summary"/></div>
<div class="ocaml_module" name="Pipe"><pre class="odoccode"><span class="keyword">module</span> <a href="http://mirage.github.io/shared-memory-ring/#Ring.Pipe" class="ocaml_internal">Pipe</a> : <code class="type"><div class="sig_block"><code class="code">functor (</code><code class="code">RW</code><code class="code"> : </code><code class="code"><a href="http://mirage.github.io/shared-memory-ring/#Ring:RW" class="ocaml_internal">RW</a></code><code class="code">) -&gt; </code><code class="code">sig</code> .. <code class="code">end</code></div></code></pre><div class="ocaml_summary"/><div class="ocaml_content">
<pre class="odoccode"><span class="VALunsafe_write"><span class="keyword">val</span> unsafe_write</span> : <code class="type"><a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a> -&gt; string -&gt; int -&gt; int -&gt; int</code></pre>
<pre class="odoccode"><span class="VALunsafe_read"><span class="keyword">val</span> unsafe_read</span> : <code class="type"><a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a> -&gt; string -&gt; int -&gt; int -&gt; int</code></pre></div></div>
<div class="ocaml_modtype" name="Bidirectional_byte_stream"><pre class="odoccode"><span class="keyword">module type</span> <a href="http://mirage.github.io/shared-memory-ring/#Ring:Bidirectional_byte_stream" class="ocaml_internal">Bidirectional_byte_stream</a> = <code class="type"><code class="code">sig</code> .. <code class="code">end</code></code></pre><div class="ocaml_summary"/><div class="ocaml_content">
<pre class="odoccode"><span class="VALinit"><span class="keyword">val</span> init</span> : <code class="type"><a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a> -&gt; unit</code></pre>
<pre class="odoccode"><span class="VALto_debug_map"><span class="keyword">val</span> to_debug_map</span> : <code class="type"><a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a> -&gt; (string * string) list</code></pre>
<div class="ocaml_module" name="Front"><pre class="odoccode"><span class="keyword">module</span> <a href="http://mirage.github.io/shared-memory-ring/#Ring:Bidirectional_byte_stream.Front" class="ocaml_internal">Front</a> : <code class="type"><code class="code">sig</code> .. <code class="code">end</code></code></pre><div class="ocaml_summary"/><div class="ocaml_content">
<pre class="odoccode"><span class="VALunsafe_write"><span class="keyword">val</span> unsafe_write</span> : <code class="type"><a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a> -&gt; string -&gt; int -&gt; int -&gt; int</code></pre>
<pre class="odoccode"><span class="VALunsafe_read"><span class="keyword">val</span> unsafe_read</span> : <code class="type"><a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a> -&gt; string -&gt; int -&gt; int -&gt; int</code></pre></div></div>
<div class="ocaml_module" name="Back"><pre class="odoccode"><span class="keyword">module</span> <a href="http://mirage.github.io/shared-memory-ring/#Ring:Bidirectional_byte_stream.Back" class="ocaml_internal">Back</a> : <code class="type"><code class="code">sig</code> .. <code class="code">end</code></code></pre><div class="ocaml_summary"/><div class="ocaml_content">
<pre class="odoccode"><span class="VALunsafe_write"><span class="keyword">val</span> unsafe_write</span> : <code class="type"><a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a> -&gt; string -&gt; int -&gt; int -&gt; int</code></pre>
<pre class="odoccode"><span class="VALunsafe_read"><span class="keyword">val</span> unsafe_read</span> : <code class="type"><a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a> -&gt; string -&gt; int -&gt; int -&gt; int</code></pre></div></div></div></div>
<pre class="odoccode"><span class="VALzero"><span class="keyword">val</span> zero</span> : <code class="type"><a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a> -&gt; unit</code></pre><div class="info"><code class="code">zero c</code> sets every byte of the <code class="code">c</code> Cstruct to zero.</div>
<pre class="odoccode"><span class="VALunsafe_load_uint32"><span class="keyword">val</span> unsafe_load_uint32</span> : <code class="type"><a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a> -&gt; int -&gt; int</code></pre>
<pre class="odoccode"><span class="VALunsafe_save_uint32"><span class="keyword">val</span> unsafe_save_uint32</span> : <code class="type"><a href="http://mirage.github.io/cstruct/#Cstruct.t">Cstruct.t</a> -&gt; int -&gt; int -&gt; unit</code></pre>
</div></div>