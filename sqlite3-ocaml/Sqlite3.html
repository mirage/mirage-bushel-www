<div class="ocaml_top"><div class="ocaml_summary"><div class="info">API for Sqlite 3.* databases</div></div>
<div class="ocaml_content"><div class="info"><h2 id="2_TITLE">Exceptions</h2></div>
<pre class="odoccode"><span class="EXCEPTIONInternalError"><span class="keyword">exception</span> InternalError</span> <span class="keyword">of</span> <code class="type">string</code></pre><div class="info"><code class="code">InternalError reason</code> is raised when the bindings detect an
unknown/unsupported situation.</div>
<pre class="odoccode"><span class="EXCEPTIONError"><span class="keyword">exception</span> Error</span> <span class="keyword">of</span> <code class="type">string</code></pre><div class="info"><code class="code">Error reason</code> is raised when some SQL operation is called on a
nonexistent handle and the functions does not return a return code,
or if there is no error code corresponding to this error.
Functions returning return codes communicate errors by returning
the specific error code.</div>
<pre class="odoccode"><span class="EXCEPTIONRangeError"><span class="keyword">exception</span> RangeError</span> <span class="keyword">of</span> <code class="type">int * int</code></pre><div class="info"><code class="code">RangeError (index, maximum)</code> is raised if some column or bind
operation refers to a nonexistent column or binding. The first
entry of the returned tuple is the specified index, the second is
the limit which was violated.</div>
<div class="info"><h2 id="2_TITLE">Types</h2></div>
<pre class="odoccode"><span class="TYPEdb"><span class="keyword">type</span> db</span></pre><div class="info">Database handle. Used to store information regarding open
databases and the error code from the last operation if the function
implementing that operation takes a database handle as a parameter.<p>NOTE: DO NOT USE THIS HANDLE WITHIN THREADS OTHER THAN THE ONE THAT
CREATED IT!!!</p><p>NOTE: database handles are closed (see db_close) automatically
when they are reclaimed by the GC unless they have already been
closed earlier by the user. It is good practice to manually close
database handles to free resources as quickly as possible.</p></div>
<pre class="odoccode"><span class="TYPEstmt"><span class="keyword">type</span> stmt</span></pre><div class="info">Compiled statement handle. Stores information about compiled
statements created by the <code class="code">prepare</code> or <code class="code">prepare_tail</code> functions.<p>NOTE: DO NOT USE THIS HANDLE WITHIN THREADS OTHER THAN THE ONE THAT
CREATED IT!!!</p></div>
<pre class="odoccode"><span class="TYPEheader"><span class="keyword">type</span> header</span> = <code class="type">string</code></pre><div class="info">Type of name of a column returned by queries.</div>
<pre class="odoccode"><span class="TYPEheaders"><span class="keyword">type</span> headers</span> = <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.header" class="ocaml_internal">header</a> array</code></pre><div class="info">Type of names of columns returned by queries.</div>
<pre class="odoccode"><span class="TYPErow"><span class="keyword">type</span> row</span> = <code class="type">string option array</code></pre><div class="info">Type of row data (with potential NULL-values)</div>
<pre class="odoccode"><span class="TYPErow_not_null"><span class="keyword">type</span> row_not_null</span> = <code class="type">string array</code></pre><div class="info">Type of row data (without NULL-values)</div>
<div class="info"><h2 id="2_TITLE">Return codes</h2></div>
<div class="ocaml_module" name="Rc"><pre class="odoccode"><span class="keyword">module</span> <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Rc" class="ocaml_internal">Rc</a> : <code class="type"><code class="code">sig</code> .. <code class="code">end</code></code></pre><div class="ocaml_summary"/><div class="ocaml_content">
<pre class="odoccode"><span class="TYPEunknown"><span class="keyword">type</span> unknown</span></pre><div class="info">Type of unknown return codes</div>
<pre class="odoccode"><span class="VALint_of_unknown"><span class="keyword">val</span> int_of_unknown</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Rc.unknown" class="ocaml_internal">unknown</a> -&gt; int</code></pre><div class="info"><code class="code">int_of_unknown n</code> converts unknown return code <code class="code">rc</code> to an
integer.</div>
<pre class="odoccode"><code><span class="TYPEt"><span class="keyword">type</span> t</span> = </code></pre><table class="typetable">
		    <tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.OK"><span class="constructor">OK</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.ERROR"><span class="constructor">ERROR</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.INTERNAL"><span class="constructor">INTERNAL</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.PERM"><span class="constructor">PERM</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.ABORT"><span class="constructor">ABORT</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.BUSY"><span class="constructor">BUSY</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.LOCKED"><span class="constructor">LOCKED</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.NOMEM"><span class="constructor">NOMEM</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.READONLY"><span class="constructor">READONLY</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.INTERRUPT"><span class="constructor">INTERRUPT</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.IOERR"><span class="constructor">IOERR</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.CORRUPT"><span class="constructor">CORRUPT</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.NOTFOUND"><span class="constructor">NOTFOUND</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.FULL"><span class="constructor">FULL</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.CANTOPEN"><span class="constructor">CANTOPEN</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.PROTOCOL"><span class="constructor">PROTOCOL</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.EMPTY"><span class="constructor">EMPTY</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.SCHEMA"><span class="constructor">SCHEMA</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.TOOBIG"><span class="constructor">TOOBIG</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.CONSTRAINT"><span class="constructor">CONSTRAINT</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.MISMATCH"><span class="constructor">MISMATCH</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.MISUSE"><span class="constructor">MISUSE</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.NOFLS"><span class="constructor">NOFLS</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.AUTH"><span class="constructor">AUTH</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.FORMAT"><span class="constructor">FORMAT</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.RANGE"><span class="constructor">RANGE</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.NOTADB"><span class="constructor">NOTADB</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.ROW"><span class="constructor">ROW</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.DONE"><span class="constructor">DONE</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.UNKNOWN"><span class="constructor">UNKNOWN</span></span> <span class="keyword">of</span> <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Rc.unknown" class="ocaml_internal">unknown</a></code></code></td></tr></table><div class="info">Type of return codes from failed or successful operations.</div>
<pre class="odoccode"><span class="VALto_string"><span class="keyword">val</span> to_string</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Rc.t" class="ocaml_internal">t</a> -&gt; string</code></pre><div class="info"><code class="code">to_string rc</code> converts return code <code class="code">rc</code> to a string.</div></div></div>
<div class="info"><h2 id="2_TITLE">Column data types</h2></div>
<div class="ocaml_module" name="Data"><pre class="odoccode"><span class="keyword">module</span> <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data" class="ocaml_internal">Data</a> : <code class="type"><code class="code">sig</code> .. <code class="code">end</code></code></pre><div class="ocaml_summary"/><div class="ocaml_content">
<pre class="odoccode"><code><span class="TYPEt"><span class="keyword">type</span> t</span> = </code></pre><table class="typetable">
		    <tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.NONE"><span class="constructor">NONE</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.NULL"><span class="constructor">NULL</span></span></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.INT"><span class="constructor">INT</span></span> <span class="keyword">of</span> <code class="type">int64</code></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.FLOAT"><span class="constructor">FLOAT</span></span> <span class="keyword">of</span> <code class="type">float</code></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.TEXT"><span class="constructor">TEXT</span></span> <span class="keyword">of</span> <code class="type">string</code></code></td></tr><tr><td align="left" valign="top"><code><span class="keyword">|</span></code></td><td align="left" valign="top"><code><span class="TYPEELTt.BLOB"><span class="constructor">BLOB</span></span> <span class="keyword">of</span> <code class="type">string</code></code></td></tr></table><div class="info">Type of columns</div>
<pre class="odoccode"><span class="VALto_string"><span class="keyword">val</span> to_string</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">t</a> -&gt; string</code></pre><div class="info"><code class="code">to_string data</code> converts <code class="code">data</code> to a string. Both <code class="code">NONE</code> and
<code class="code">NULL</code> are converted to the empty string.</div>
<pre class="odoccode"><span class="VALto_string_debug"><span class="keyword">val</span> to_string_debug</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">t</a> -&gt; string</code></pre><div class="info"><code class="code">to_string_debug data</code> converts <code class="code">data</code> to a string including the
data constructor. The contents of blobs will not be printed,
only its length. Useful for debugging.</div></div></div>
<div class="info"><h2 id="2_TITLE">General database operations</h2></div>
<pre class="odoccode"><span class="VALdb_open"><span class="keyword">val</span> db_open</span> : <code class="type">?mode:[ `NO_CREATE | `READONLY ] -&gt;
?mutex:[ `FULL | `NO ] -&gt;
?cache:[ `PRIVATE | `SHARED ] -&gt; ?vfs:string -&gt; string -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.db" class="ocaml_internal">db</a></code></pre><div class="info"><code class="code">db_open ?mode ?mutex ?cache ?vfs filename</code> opens the database file
<code class="code">filename</code>, and returns a database handle.<p>The optional arguments <code class="code">mode</code> and <code class="code">mutex</code> are only meaningful with SQlite
versions &gt;= 3.5, <code class="code">cache</code> only for versions &gt;= 3.6.18. For older versions an
exception will be raised if any of them is set to a non-default value. The
database is opened read-only if <code class="code">`READONLY</code> is passed as mode. The database
file will not be created if it is missing and <code class="code">`NO_CREATE</code> is set. <code class="code">mutex</code>
determines how the database is accessed. The mutex parameters <code class="code">`NO</code> and
<code class="code">`FULL</code> correspond to <code class="code">SQLITE_OPEN_NOMUTEX</code> and <code class="code">SQLITE_OPEN_FULLMUTEX</code> in
the SQLite3 API respectively. The cache parameters <code class="code">`SHARED</code> and <code class="code">`PRIVATE</code>
correspond to <code class="code">SQLITE_OPEN_SHAREDCACHE</code> and <code class="code">SQLITE_OPEN_PRIVATECACHE</code> in
the SQLite3 API respectively.</p><div class="parameters"><div class="param_info"><code class="code">mode</code> : default = read-write, create</div><div class="param_info"><code class="code">mutex</code> : default = nothing</div><div class="param_info"><code class="code">cache</code> : default = nothing</div><div class="param_info"><code class="code">vfs</code> : default = nothing</div></div></div>
<pre class="odoccode"><span class="VALdb_close"><span class="keyword">val</span> db_close</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.db" class="ocaml_internal">db</a> -&gt; bool</code></pre><div class="info"><code class="code">db_close db</code> closes database <code class="code">db</code> and invalidates the handle. <b>Raises</b> <code>SqliteError</code> if an invalid database handle is passed.<br/> <b>Returns</b> <code class="code">false</code> if database was busy (database not closed in this
case!), <code class="code">true</code> otherwise.</div>
<pre class="odoccode"><span class="VALenable_load_extension"><span class="keyword">val</span> enable_load_extension</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.db" class="ocaml_internal">db</a> -&gt; bool -&gt; bool</code></pre><div class="info"><code class="code">enable_load_extension db onoff</code> enable/disable the sqlite3 load
extension. <b>Returns</b> <code class="code">false</code> if the operation fails, <code class="code">true</code>
otherwise.</div>
<pre class="odoccode"><span class="VALerrcode"><span class="keyword">val</span> errcode</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.db" class="ocaml_internal">db</a> -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Rc.t" class="ocaml_internal">Rc.t</a></code></pre><div class="info"><code class="code">errcode db</code> <b>Raises</b> <code>SqliteError</code> if an invalid database handle is passed.<br/> <b>Returns</b> the error code of the last operation on database
<code class="code">db</code>.</div>
<pre class="odoccode"><span class="VALerrmsg"><span class="keyword">val</span> errmsg</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.db" class="ocaml_internal">db</a> -&gt; string</code></pre><div class="info"><code class="code">errmsg db</code> <b>Raises</b> <code>SqliteError</code> if an invalid database handle is passed.<br/> <b>Returns</b> the error message of the last operation on
database <code class="code">db</code>.</div>
<pre class="odoccode"><span class="VALlast_insert_rowid"><span class="keyword">val</span> last_insert_rowid</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.db" class="ocaml_internal">db</a> -&gt; int64</code></pre><div class="info"><code class="code">last_insert_rowid db</code> <b>Raises</b> <code>SqliteError</code> if an invalid database handle is passed.<br/> <b>Returns</b> the index of the row inserted by
the last operation on database <code class="code">db</code>.</div>
<pre class="odoccode"><span class="VALexec"><span class="keyword">val</span> exec</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.db" class="ocaml_internal">db</a> -&gt; ?cb:(<a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.row" class="ocaml_internal">row</a> -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.headers" class="ocaml_internal">headers</a> -&gt; unit) -&gt; string -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Rc.t" class="ocaml_internal">Rc.t</a></code></pre><div class="info"><code class="code">exec db ?cb sql</code> performs SQL-operation <code class="code">sql</code> on database <code class="code">db</code>.
If the operation contains query statements, then the callback function
<code class="code">cb</code> will be called for each matching row. The first parameter of
the callback is the contents of the row, the second paramater are the
headers of the columns associated with the row. Exceptions raised
within the callback will abort the execution and escape exec.<div class="parameters"><div class="param_info"><code class="code">cb</code> : default = no callback</div></div> <b>Raises</b> <code>SqliteError</code> if an invalid database handle is passed.<br/> <b>Returns</b> the return code of the operation.</div>
<pre class="odoccode"><span class="VALexec_no_headers"><span class="keyword">val</span> exec_no_headers</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.db" class="ocaml_internal">db</a> -&gt; cb:(<a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.row" class="ocaml_internal">row</a> -&gt; unit) -&gt; string -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Rc.t" class="ocaml_internal">Rc.t</a></code></pre><div class="info"><code class="code">exec_no_headers db ?cb sql</code> performs SQL-operation <code class="code">sql</code> on database
<code class="code">db</code>. If the operation contains query statements, then the callback
function <code class="code">cb</code> will be called for each matching row. The parameter
of the callback is the contents of the row. Exceptions raised within
the callback will abort the execution and escape exec_no_headers. <b>Raises</b> <code>SqliteError</code> if an invalid database handle is passed.<br/> <b>Returns</b> the return code of the operation.</div>
<pre class="odoccode"><span class="VALexec_not_null"><span class="keyword">val</span> exec_not_null</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.db" class="ocaml_internal">db</a> -&gt; cb:(<a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.row_not_null" class="ocaml_internal">row_not_null</a> -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.headers" class="ocaml_internal">headers</a> -&gt; unit) -&gt; string -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Rc.t" class="ocaml_internal">Rc.t</a></code></pre><div class="info"><code class="code">exec_not_null db ~cb sql</code> performs SQL-operation <code class="code">sql</code> on database
<code class="code">db</code>. If the operation contains query statements, then the callback
function <code class="code">cb</code> will be called for each matching row. The first
parameter of the callback is the contents of the row, which must
not contain NULL-values, the second paramater are the headers of
the columns associated with the row. Exceptions raised within the
callback will abort the execution and escape exec_not_null. <b>Raises</b> <code>SqliteError</code> if an invalid database handle is passed.<br/><code>SqliteError</code> if a row contains NULL.<br/> <b>Returns</b> the return code of the operation.</div>
<pre class="odoccode"><span class="VALexec_not_null_no_headers"><span class="keyword">val</span> exec_not_null_no_headers</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.db" class="ocaml_internal">db</a> -&gt; cb:(<a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.row_not_null" class="ocaml_internal">row_not_null</a> -&gt; unit) -&gt; string -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Rc.t" class="ocaml_internal">Rc.t</a></code></pre><div class="info"><code class="code">exec_not_null_no_headers db ~cb sql</code> performs SQL-operation <code class="code">sql</code>
on database <code class="code">db</code>. If the operation contains query statements, then
the callback function <code class="code">cb</code> will be called for each matching row.
The parameter of the callback is the contents of the row, which must
not contain NULL-values. Exceptions raised within the callback will
abort the execution and escape exec_not_null_no_headers. <b>Raises</b> <code>SqliteError</code> if an invalid database handle is passed.<br/><code>SqliteError</code> if a row contains NULL.<br/> <b>Returns</b> the return code of the operation.</div>
<pre class="odoccode"><span class="VALchanges"><span class="keyword">val</span> changes</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.db" class="ocaml_internal">db</a> -&gt; int</code></pre><div class="info"><code class="code">changes db</code> <b>Returns</b> the number of rows that were changed
or inserted or deleted by the most recently completed SQL statement
on database <code class="code">db</code>.</div>
<div class="info"><h2 id="2_TITLE">Fine grained query operations</h2></div>
<pre class="odoccode"><span class="VALprepare"><span class="keyword">val</span> prepare</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.db" class="ocaml_internal">db</a> -&gt; string -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.stmt" class="ocaml_internal">stmt</a></code></pre><div class="info"><code class="code">prepare db sql</code> compile SQL-statement <code class="code">sql</code> for database <code class="code">db</code>
into bytecode. The statement may be only partially compiled.
In this case prepare_tail can be called on the returned statement
to compile the remaining part of the SQL-statement.<p>NOTE: this really uses the C-function <code class="code">sqlite3_prepare_v2</code>,
i.e. avoids the older, deprecated <code class="code">sqlite3_prepare</code>-function.</p> <b>Raises</b> <code>SqliteError</code> if an invalid database handle is passed.<br/><code>SqliteError</code> if the statement could not be prepared.<br/></div>
<pre class="odoccode"><span class="VALprepare_tail"><span class="keyword">val</span> prepare_tail</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.stmt" class="ocaml_internal">stmt</a> -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.stmt" class="ocaml_internal">stmt</a> option</code></pre><div class="info"><code class="code">prepare_tail stmt</code> compile the remaining part of the SQL-statement
<code class="code">stmt</code> to bytecode. <b>Raises</b> <code>SqliteError</code> if the statement could not be prepared.<br/> <b>Returns</b> <code class="code">None</code> if there was no remaining part,
or <code class="code">Some remaining_part</code> otherwise.<p>NOTE: this really uses the C-function <code class="code">sqlite3_prepare_v2</code>,
i.e. avoids the older, deprecated <code class="code">sqlite3_prepare</code>-function.</p></div>
<pre class="odoccode"><span class="VALrecompile"><span class="keyword">val</span> recompile</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.stmt" class="ocaml_internal">stmt</a> -&gt; unit</code></pre><div class="info"><code class="code">recompile stmt</code> recompiles the SQL-statement associated with <code class="code">stmt</code>
to bytecode. The statement may be only partially compiled. In this
case prepare_tail can be called on the statement to compile the
remaining part of the SQL-statement. Call this function if the
statement expires due to some schema change. <b>Raises</b> <code>SqliteError</code> if the statement could not be recompiled.<br/></div>
<pre class="odoccode"><span class="VALstep"><span class="keyword">val</span> step</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.stmt" class="ocaml_internal">stmt</a> -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Rc.t" class="ocaml_internal">Rc.t</a></code></pre><div class="info"><code class="code">step stmt</code> performs one step of the query associated with
SQL-statement <code class="code">stmt</code>. <b>Raises</b> <code>SqliteError</code> if the step could not be executed.<br/> <b>Returns</b> the return code of this operation.</div>
<pre class="odoccode"><span class="VALfinalize"><span class="keyword">val</span> finalize</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.stmt" class="ocaml_internal">stmt</a> -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Rc.t" class="ocaml_internal">Rc.t</a></code></pre><div class="info"><code class="code">finalize stmt</code> finalizes the statement <code class="code">stmt</code>. After finalization,
the only valid usage of the statement is to use it in prepare_tail,
or to recompile it. <b>Raises</b> <code>SqliteError</code> if the statement could not be finalized.<br/> <b>Returns</b> the return code of this operation.</div>
<pre class="odoccode"><span class="VALreset"><span class="keyword">val</span> reset</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.stmt" class="ocaml_internal">stmt</a> -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Rc.t" class="ocaml_internal">Rc.t</a></code></pre><div class="info"><code class="code">reset stmt</code> resets the statement <code class="code">stmt</code>, e.g. to restart the query,
perhaps with different bindings. <b>Raises</b> <code>SqliteError</code> if the statement could not be reset.<br/> <b>Returns</b> the return code of this operation.</div>
<pre class="odoccode"><span class="VALsleep"><span class="keyword">val</span> sleep</span> : <code class="type">int -&gt; int</code></pre><div class="info"><code class="code">sleep ms</code> sleeps at least <code class="code">ms</code> milliseconds. <b>Returns</b> the number of
milliseconds of sleep actually requested from the operating system.</div>
<div class="info"><h2 id="2_TITLE">Data query</h2></div>
<pre class="odoccode"><span class="VALdata_count"><span class="keyword">val</span> data_count</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.stmt" class="ocaml_internal">stmt</a> -&gt; int</code></pre><div class="info"><code class="code">data_count stmt</code> <b>Raises</b> <code>SqliteError</code> if the statement is invalid.<br/> <b>Returns</b> the number of columns in the result of
the last step of statement <code class="code">stmt</code>.</div>
<pre class="odoccode"><span class="VALcolumn_count"><span class="keyword">val</span> column_count</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.stmt" class="ocaml_internal">stmt</a> -&gt; int</code></pre><div class="info"><code class="code">column_count stmt</code> <b>Raises</b> <code>SqliteError</code> if the statement is invalid.<br/> <b>Returns</b> the number of columns that would be
returned by executing statement <code class="code">stmt</code>.</div>
<pre class="odoccode"><span class="VALcolumn"><span class="keyword">val</span> column</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.stmt" class="ocaml_internal">stmt</a> -&gt; int -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">Data.t</a></code></pre><div class="info"><code class="code">column stmt n</code> <b>Raises</b> <code>RangeError</code> if <code class="code">n</code> is out of range.<br/><code>SqliteError</code> if the statement is invalid.<br/> <b>Returns</b> the data in column <code class="code">n</code> of the
result of the last step of statement <code class="code">stmt</code>.</div>
<pre class="odoccode"><span class="VALcolumn_name"><span class="keyword">val</span> column_name</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.stmt" class="ocaml_internal">stmt</a> -&gt; int -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.header" class="ocaml_internal">header</a></code></pre><div class="info"><code class="code">column_name stmt n</code> <b>Raises</b> <code>RangeError</code> if <code class="code">n</code> is out of range.<br/><code>SqliteError</code> if the statement is invalid.<br/> <b>Returns</b> the header of column <code class="code">n</code> in the
result set of statement <code class="code">stmt</code>.</div>
<pre class="odoccode"><span class="VALcolumn_decltype"><span class="keyword">val</span> column_decltype</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.stmt" class="ocaml_internal">stmt</a> -&gt; int -&gt; string option</code></pre><div class="info"><code class="code">column_decltype stmt n</code> <b>Raises</b> <code>RangeError</code> if <code class="code">n</code> is out of range.<br/><code>SqliteError</code> if the statement is invalid.<br/> <b>Returns</b> the declared type of the specified
column in the result set of statement <code class="code">stmt</code>.</div>
<div class="info"><h2 id="2_TITLE">Binding data to the query</h2></div>
<pre class="odoccode"><span class="VALbind"><span class="keyword">val</span> bind</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.stmt" class="ocaml_internal">stmt</a> -&gt; int -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">Data.t</a> -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Rc.t" class="ocaml_internal">Rc.t</a></code></pre><div class="info"><code class="code">bind stmt n data</code> binds the value <code class="code">data</code> to the free variable at
position <code class="code">n</code> of statement <code class="code">stmt</code>. NOTE: the first variable has
index <code class="code">1</code>! <b>Raises</b> <code>RangeError</code> if <code class="code">n</code> is out of range.<br/><code>SqliteError</code> if the statement is invalid.<br/> <b>Returns</b> the return code of this operation.</div>
<pre class="odoccode"><span class="VALbind_parameter_count"><span class="keyword">val</span> bind_parameter_count</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.stmt" class="ocaml_internal">stmt</a> -&gt; int</code></pre><div class="info"><code class="code">bind_parameter_count stmt</code> <b>Raises</b> <code>SqliteError</code> if the statement is invalid.<br/> <b>Returns</b> the number of free variables in
statement <code class="code">stmt</code>.</div>
<pre class="odoccode"><span class="VALbind_parameter_name"><span class="keyword">val</span> bind_parameter_name</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.stmt" class="ocaml_internal">stmt</a> -&gt; int -&gt; string option</code></pre><div class="info"><code class="code">bind_parameter_name stmt n</code> <b>Raises</b> <code>RangeError</code> if <code class="code">n</code> is out of range.<br/><code>SqliteError</code> if the statement is invalid.<br/> <b>Returns</b> <code class="code">Some parameter_name</code> of the free
variable at position <code class="code">n</code> of statement <code class="code">stmt</code>, or <code class="code">None</code> if it is
ordinary (&quot;?&quot;).</div>
<pre class="odoccode"><span class="VALbind_parameter_index"><span class="keyword">val</span> bind_parameter_index</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.stmt" class="ocaml_internal">stmt</a> -&gt; string -&gt; int</code></pre><div class="info"><code class="code">bind_parameter_index stmt name</code> <b>Raises</b> <code>Not_found</code> if <code class="code">name</code> was not found.<br/><code>SqliteError</code> if the statement is invalid.<br/> <b>Returns</b> the position of the free
variable with name <code class="code">name</code> in statement <code class="code">stmt</code>.</div>
<pre class="odoccode"><span class="VALclear_bindings"><span class="keyword">val</span> clear_bindings</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.stmt" class="ocaml_internal">stmt</a> -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Rc.t" class="ocaml_internal">Rc.t</a></code></pre><div class="info"><code class="code">clear_bindings stmt</code> resets all bindings associated with prepared
statement <code class="code">stmt</code>. <b>Raises</b> <code>SqliteError</code> if the statement is invalid.<br/> <b>Returns</b> the return code of this operation.</div>
<div class="info"><h2 id="2_TITLE">Stepwise query convenience functions</h2></div>
<pre class="odoccode"><span class="VALrow_data"><span class="keyword">val</span> row_data</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.stmt" class="ocaml_internal">stmt</a> -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">Data.t</a> array</code></pre><div class="info"><code class="code">row_data stmt</code> <b>Raises</b> <code>SqliteError</code> if the statement is invalid.<br/> <b>Returns</b> all data values in the row returned by the
last query step performed with statement <code class="code">stmt</code>.</div>
<pre class="odoccode"><span class="VALrow_names"><span class="keyword">val</span> row_names</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.stmt" class="ocaml_internal">stmt</a> -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.headers" class="ocaml_internal">headers</a></code></pre><div class="info"><code class="code">row_names stmt</code> <b>Raises</b> <code>SqliteError</code> if the statement is invalid.<br/> <b>Returns</b> all column headers of the row returned by the
last query step performed with statement <code class="code">stmt</code>.</div>
<pre class="odoccode"><span class="VALrow_decltypes"><span class="keyword">val</span> row_decltypes</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.stmt" class="ocaml_internal">stmt</a> -&gt; string option array</code></pre><div class="info"><code class="code">row_decltypes stmt</code> <b>Raises</b> <code>SqliteError</code> if the statement is invalid.<br/> <b>Returns</b> all column type declarations of the
row returned by the last query step performed with statement <code class="code">stmt</code>.</div>
<div class="info"><h2 id="2_TITLE">User-defined functions</h2></div>
<pre class="odoccode"><span class="VALcreate_funN"><span class="keyword">val</span> create_funN</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.db" class="ocaml_internal">db</a> -&gt; string -&gt; (<a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">Data.t</a> array -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">Data.t</a>) -&gt; unit</code></pre><div class="info"><code class="code">create_funN db name f</code> registers function <code class="code">f</code> under name <code class="code">name</code>
with database handle <code class="code">db</code>. The function has arity <code class="code">N</code>. <b>Raises</b> <code>SqliteError</code> if an invalid database handle is passed.<br/></div>
<pre class="odoccode"><span class="VALcreate_fun0"><span class="keyword">val</span> create_fun0</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.db" class="ocaml_internal">db</a> -&gt; string -&gt; (unit -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">Data.t</a>) -&gt; unit</code></pre><div class="info"><code class="code">create_funN db name f</code> registers function <code class="code">f</code> under name <code class="code">name</code>
with database handle <code class="code">db</code>. The function has arity <code class="code">0</code>. <b>Raises</b> <code>SqliteError</code> if an invalid database handle is passed.<br/></div>
<pre class="odoccode"><span class="VALcreate_fun1"><span class="keyword">val</span> create_fun1</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.db" class="ocaml_internal">db</a> -&gt; string -&gt; (<a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">Data.t</a> -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">Data.t</a>) -&gt; unit</code></pre><div class="info"><code class="code">create_fun1 db name f</code> registers function <code class="code">f</code> under name <code class="code">name</code>
with database handle <code class="code">db</code>. The function has arity <code class="code">1</code>. <b>Raises</b> <code>SqliteError</code> if an invalid database handle is passed.<br/></div>
<pre class="odoccode"><span class="VALcreate_fun2"><span class="keyword">val</span> create_fun2</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.db" class="ocaml_internal">db</a> -&gt; string -&gt; (<a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">Data.t</a> -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">Data.t</a> -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">Data.t</a>) -&gt; unit</code></pre><div class="info"><code class="code">create_fun2 db name f</code> registers function <code class="code">f</code> under name <code class="code">name</code>
with database handle <code class="code">db</code>. The function has arity <code class="code">2</code>. <b>Raises</b> <code>SqliteError</code> if an invalid database handle is passed.<br/></div>
<pre class="odoccode"><span class="VALcreate_fun3"><span class="keyword">val</span> create_fun3</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.db" class="ocaml_internal">db</a> -&gt; string -&gt; (<a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">Data.t</a> -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">Data.t</a> -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">Data.t</a> -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">Data.t</a>) -&gt; unit</code></pre><div class="info"><code class="code">create_fun3 db name f</code> registers function <code class="code">f</code> under name <code class="code">name</code>
with database handle <code class="code">db</code>. The function has arity <code class="code">3</code>. <b>Raises</b> <code>SqliteError</code> if an invalid database handle is passed.<br/></div>
<pre class="odoccode"><span class="VALdelete_function"><span class="keyword">val</span> delete_function</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.db" class="ocaml_internal">db</a> -&gt; string -&gt; unit</code></pre><div class="info"><code class="code">delete_function db name</code> deletes function with name <code class="code">name</code> from
database handle <code class="code">db</code>. <b>Raises</b> <code>SqliteError</code> if an invalid database handle is passed.<br/></div>
<pre class="odoccode"><span class="VALbusy_timeout"><span class="keyword">val</span> busy_timeout</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.db" class="ocaml_internal">db</a> -&gt; int -&gt; unit</code></pre><div class="info"><code class="code">busy_timeout db ms</code> sets a busy handler that sleeps for a
specified amount of time when a table is locked. The handler will
sleep multiple times until at least <code class="code">ms</code> milliseconds of sleeping
have accumulated. <b>Raises</b> <code>SqliteError</code> if an invalid database handle is passed.<br/></div>
<div class="ocaml_module" name="Aggregate"><pre class="odoccode"><span class="keyword">module</span> <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Aggregate" class="ocaml_internal">Aggregate</a> : <code class="type"><code class="code">sig</code> .. <code class="code">end</code></code></pre><div class="ocaml_summary"/><div class="ocaml_content">
<pre class="odoccode"><span class="VALcreate_fun0"><span class="keyword">val</span> create_fun0</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.db" class="ocaml_internal">db</a> -&gt; string -&gt; init:'a -&gt; step:('a -&gt; 'a) -&gt; final:('a -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">Data.t</a>) -&gt; unit</code></pre><div class="info"><code class="code">create_fun0 db name ~init ~step ~final</code> registers the step and
finalizer functions under name <code class="code">name</code> with database handle <code class="code">db</code>.
This function has arity <code class="code">0</code>. <b>Raises</b> <code>SqliteError</code> if an invalid database handle is passed.<br/></div>
<pre class="odoccode"><span class="VALcreate_fun1"><span class="keyword">val</span> create_fun1</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.db" class="ocaml_internal">db</a> -&gt;
string -&gt;
init:'a -&gt; step:('a -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">Data.t</a> -&gt; 'a) -&gt; final:('a -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">Data.t</a>) -&gt; unit</code></pre><div class="info"><code class="code">create_fun1 db name ~init ~step ~final</code> registers the step and
finalizer functions under name <code class="code">name</code> with database handle <code class="code">db</code>.
This function has arity <code class="code">1</code>. <b>Raises</b> <code>SqliteError</code> if an invalid database handle is passed.<br/></div>
<pre class="odoccode"><span class="VALcreate_fun2"><span class="keyword">val</span> create_fun2</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.db" class="ocaml_internal">db</a> -&gt;
string -&gt;
init:'a -&gt;
step:('a -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">Data.t</a> -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">Data.t</a> -&gt; 'a) -&gt; final:('a -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">Data.t</a>) -&gt; unit</code></pre><div class="info"><code class="code">create_fun2 db name ~init ~step ~final</code> registers the step and
finalizer functions under name <code class="code">name</code> with database handle <code class="code">db</code>.
This function has arity <code class="code">2</code>. <b>Raises</b> <code>SqliteError</code> if an invalid database handle is passed.<br/></div>
<pre class="odoccode"><span class="VALcreate_fun3"><span class="keyword">val</span> create_fun3</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.db" class="ocaml_internal">db</a> -&gt;
string -&gt;
init:'a -&gt;
step:('a -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">Data.t</a> -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">Data.t</a> -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">Data.t</a> -&gt; 'a) -&gt; final:('a -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">Data.t</a>) -&gt; unit</code></pre><div class="info"><code class="code">create_fun3 db name ~init ~step ~final</code> registers the step and
finalizer functions under name <code class="code">name</code> with database handle <code class="code">db</code>.
This function has arity <code class="code">3</code>. <b>Raises</b> <code>SqliteError</code> if an invalid database handle is passed.<br/></div>
<pre class="odoccode"><span class="VALcreate_funN"><span class="keyword">val</span> create_funN</span> : <code class="type"><a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.db" class="ocaml_internal">db</a> -&gt;
string -&gt;
init:'a -&gt; step:('a -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">Data.t</a> array -&gt; 'a) -&gt; final:('a -&gt; <a href="http://mirage.github.io/sqlite3-ocaml/#Sqlite3.Data.t" class="ocaml_internal">Data.t</a>) -&gt; unit</code></pre><div class="info"><code class="code">create_funN db name ~init ~step ~final</code> registers the step and
finalizer functions under name <code class="code">name</code> with database handle <code class="code">db</code>.
This function has arity <code class="code">N</code>. <b>Raises</b> <code>SqliteError</code> if an invalid database handle is passed.<br/></div></div></div>
</div></div>